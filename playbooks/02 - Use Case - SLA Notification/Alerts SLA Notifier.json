{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Alerts SLA Notifier",
    "aliasName": null,
    "tag": null,
    "description": "Notify users when SLA is about to be breached",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/904b64ba-4c29-43c9-a46f-62e117bd4aa3",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/7c8470ca-69b7-4710-bc67-ea049d0d64db",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Compute Notification Bodies",
            "description": null,
            "arguments": {
                "_update_attributes": "{% set red_color='<font color = \"red\"><strong>{}<\/strong><\/font>' %}\n{% set orange_color='<font color = \"orange\"><strong>{}<\/strong><\/font>' %}\n{% macro build_ack_sla_msg(alert) %}{{orange_color.format(alert.remaining_ack_time) ~ '\\' Before Ack SLA breach' if alert.remaining_ack_time > 0 else red_color.format(alert.remaining_ack_time) ~ '\\' since Ack SLA breach'}}{% endmacro %}\n{% macro build_res_sla_msg(alert) %}{{orange_color.format(alert.remaining_response_time) ~ '\\' Before Res SLA breach' if alert.remaining_response_time > 0 else red_color.format(alert.remaining_response_time) ~ '\\' Since Res SLA breach'}}{% endmacro %}\n\n{%for entry in vars.alerts%}\n{{ entry.update({'Acknowledgment SLA Status':build_ack_sla_msg(entry)}) }}\n{{ entry.update({'Response SLA Status':build_res_sla_msg(entry)}) }}\n{{ entry.update({'Ack Due By':arrow.get(entry.dueBy).to(\"UTC\").format(\"DD\/MMM HH:mm\")}) }}\n{{ entry.update({'Response Due By':arrow.get(entry.respDueDate).to(\"UTC\").format(\"DD\/MMM HH:mm\")}) }}\n{{ entry.update({'Assigned To':entry.assignedTo.email})}}\n{%endfor%}"
            },
            "status": null,
            "top": "1245",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "1ed18797-7008-4067-9d34-8dff5eeb7737"
        },
        {
            "@type": "WorkflowStep",
            "name": "Playbook Configured",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "yes",
                        "step_iri": "\/api\/3\/workflow_steps\/7ba0643b-fa97-4bc0-a302-308a18bd23c6",
                        "condition": "{{ vars.sla_config is not none and 'minutesToSLABreach' in vars.sla_config }}",
                        "step_name": "Get PLaybook Configuration"
                    },
                    {
                        "option": "no",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/7f2fc076-bbe7-46f9-be68-4cf05156b221",
                        "step_name": "Set SLA Notification Method"
                    }
                ]
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "39dc3f2d-b5e0-42d4-a978-3aad0af0a37c"
        },
        {
            "@type": "WorkflowStep",
            "name": "No Configuraiton Set",
            "description": null,
            "arguments": {
                "params": [],
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "560",
            "left": "960",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "4d56a1d8-83de-48b1-8486-242b14446290"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Configuration Global Vars",
            "description": null,
            "arguments": {
                "params": {
                    "macro": "{{vars.sla_notification_global_var_name}}",
                    "value": "{{vars.sla_config|toJSON}}"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create\/Update Global Variables",
                "step_variables": []
            },
            "status": null,
            "top": "560",
            "left": "600",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "53082393-d31b-430b-9f26-e597d73f2077"
        },
        {
            "@type": "WorkflowStep",
            "name": "Exclude Unbreeched SLAs",
            "description": null,
            "arguments": {
                "__create_eligible_alerts": "{%for entry in vars.all_alerts%}\n{%if (entry.remaining_ack_time < vars.minutes_left) or (entry.remaining_ack_time < vars.minutes_left)%}\n{{vars.alerts.append(entry)}}\n{%endif%}\n{%endfor%}"
            },
            "status": null,
            "top": "1110",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "60844ff8-2bbb-4d5a-9b96-e4cc550f1c3d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Alert Attributes",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "logic": "AND",
                            "filters": [
                                {
                                    "type": "datetime",
                                    "logic": "AND",
                                    "_field": "createDate",
                                    "_value": {
                                        "differenceType": "days",
                                        "differenceValue": -1
                                    },
                                    "filters": [
                                        {
                                            "type": "datetime",
                                            "field": "createDate",
                                            "value": "{{getRelativeDate(0,0,-1,\"end\",\"end\",\"end\")}}",
                                            "operator": "gt"
                                        }
                                    ],
                                    "_operator": "gt"
                                }
                            ]
                        },
                        {
                            "logic": "OR",
                            "filters": [
                                {
                                    "type": "array",
                                    "field": "ackSlaStatus",
                                    "value": [
                                        "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                        "\/api\/3\/picklists\/3654f428-d23d-4683-a44e-82cc54f4f32b"
                                    ],
                                    "module": "ackSlaStatus",
                                    "display": "",
                                    "operator": "in",
                                    "template": "multiselectpicklist",
                                    "enableJinja": true,
                                    "OPERATOR_KEY": "$",
                                    "useInOperator": true,
                                    "previousOperator": "in",
                                    "previousTemplate": "multiselectpicklist"
                                },
                                {
                                    "type": "object",
                                    "field": "ackSlaStatus",
                                    "value": "true",
                                    "_value": {
                                        "@id": "true",
                                        "display": "",
                                        "itemValue": ""
                                    },
                                    "operator": "isnull"
                                }
                            ]
                        },
                        {
                            "logic": "AND",
                            "filters": [
                                {
                                    "type": "datetime",
                                    "field": "dueBy",
                                    "value": "false",
                                    "operator": "isnull"
                                },
                                {
                                    "type": "datetime",
                                    "field": "respDueDate",
                                    "value": "false",
                                    "operator": "isnull"
                                }
                            ]
                        }
                    ],
                    "__selectFields": [
                        "name",
                        "assignedTo",
                        "dueBy",
                        "respDueDate"
                    ]
                },
                "module": "alerts?$limit=10",
                "checkboxFields": true,
                "step_variables": {
                    "all_alerts": "{{vars.result}}"
                }
            },
            "status": null,
            "top": "840",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "7071eeaa-3adb-4b42-b632-01f3f7d744c8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get PLaybook Configuration",
            "description": "- minutes_left: Configure the number of minutes left before the notification is sent\n- email_recipient: if set it will be the recipient of all notifications, else the record owner will receive it\n- create_announcement: if set to True, an announcement record will be created which can be used as a trigger for a standard FortiSOAR notification",
            "arguments": {
                "alerts": "[]",
                "channel_name": "{{vars.sla_config.mSTeamsChannelName}}",
                "minutes_left": "{{vars.sla_config.minutesToSLABreach}}",
                "email_recipient": "{{vars.sla_config.recipientEmailAddress}}",
                "create_announcement": "{{vars.sla_config.createAnnouncements}}"
            },
            "status": null,
            "top": "705",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "7ba0643b-fa97-4bc0-a302-308a18bd23c6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "7c8470ca-69b7-4710-bc67-ea049d0d64db"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set SLA Notification Method",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Configuration",
                        "description": "**Notification recipient:**\n\n- Recipient Email Address: The notification will be sent to an email address you specifyin the **Recipient email address** field. If you leave it blank the the notification will be sent to the assigned analyst in the record\n\n**MS Teams Group:**\n\n- If set an SLA notification message will be sent to the group specified in the field: MS Teams Group. If no group name is provided the MS Teams notification will be disabled\n\n**Create Announcements:**\n\n- The announcements records are created for each notifications allowing you to use it as a trigger for a system notification.",
                        "inputVariables": [
                            {
                                "name": "recipientEmailAddress",
                                "type": "string",
                                "label": "Recipient Email Address",
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "text",
                                "required": false,
                                "_expanded": false,
                                "defaultValue": null,
                                "_previousName": "recipient",
                                "useRecordFieldDefault": false
                            },
                            {
                                "name": "mSTeamsChannelName",
                                "type": "string",
                                "label": "MS Teams Channel Name",
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "text",
                                "required": false,
                                "_expanded": false,
                                "defaultValue": null,
                                "_previousName": "",
                                "useRecordFieldDefault": false
                            },
                            {
                                "name": "createAnnouncements",
                                "type": "boolean",
                                "label": "Create Announcements",
                                "title": "Checkbox",
                                "usable": true,
                                "tooltip": "",
                                "dataType": "checkbox",
                                "formType": "checkbox",
                                "required": false,
                                "_expanded": false,
                                "mmdUpdate": true,
                                "collection": false,
                                "searchable": true,
                                "templateUrl": "app\/components\/form\/fields\/checkbox.html",
                                "defaultValue": null,
                                "_previousName": "createAnnouncement",
                                "lengthConstraint": false,
                                "allowedEncryption": false,
                                "allowedGridColumn": true,
                                "useRecordFieldDefault": false
                            },
                            {
                                "name": "minutesToSLABreach",
                                "type": "integer",
                                "label": "Minutes To SLA Breach",
                                "title": "Integer Field",
                                "usable": true,
                                "tooltip": "",
                                "dataType": "integer",
                                "formType": "integer",
                                "required": false,
                                "_expanded": true,
                                "mmdUpdate": true,
                                "collection": false,
                                "searchable": true,
                                "templateUrl": "app\/components\/form\/fields\/integer.html",
                                "defaultValue": 10,
                                "_previousName": "minutesToSLA",
                                "lengthConstraint": true,
                                "allowedEncryption": false,
                                "allowedGridColumn": true,
                                "useRecordFieldDefault": false
                            }
                        ]
                    }
                },
                "record": "",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": false,
                "step_variables": {
                    "sla_config": "{\n\"createAnnouncements\":\"{{vars.result.input.createAnnouncements}}\",\n\"minutesToSLABreach\":\"{{vars.result.input.minutesToSLABreach}}\",\n\"mSTeamsChannelName\":\"{{vars.result.input.mSTeamsChannelName}}\",\n\"recipientEmailAddress\":\"{{vars.result.input.recipientEmailAddress}}\"\n}"
                },
                "response_mapping": {
                    "options": [
                        {
                            "option": "Save",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/53082393-d31b-430b-9f26-e597d73f2077"
                        },
                        {
                            "option": "Cancel",
                            "step_iri": "\/api\/3\/workflow_steps\/4d56a1d8-83de-48b1-8486-242b14446290"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "420",
            "left": "780",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "7f2fc076-bbe7-46f9-be68-4cf05156b221"
        },
        {
            "@type": "WorkflowStep",
            "name": "Single Recipient",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "yes",
                        "step_iri": "\/api\/3\/workflow_steps\/b927169b-68d0-47e5-9c98-2c50849f4d77",
                        "condition": "{{ vars.email_recipient | length > 0 }}",
                        "step_name": "Generate Email Body"
                    },
                    {
                        "option": "no",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/ab3b75bc-f2ff-4a0e-81b5-681299d9bbd1",
                        "step_name": "Send Notification Emails"
                    }
                ]
            },
            "status": null,
            "top": "1380",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "833ff579-0d3b-471e-8fb4-8f602a69e9eb"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": "- minutes_left: Configure the number of minutes left before the notification is sent\n- email_recipient: if set it will be the recipient of all notifications, else the record owner will receive it\n- create_announcement: if set to True, an announcement record will be created which can be used as a trigger for a standard FortiSOAR notification",
            "arguments": {
                "alerts": "[]",
                "sla_config": "{{globalVars.SLA_Notification_Config}}",
                "sla_notification_global_var_name": "SLA_Notification_Config"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "83937a9c-d0c1-41c1-a961-44888db15d8e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Notification Emails",
            "description": null,
            "arguments": {
                "name": "Exchange",
                "when": "{{vars.alerts|length > 0}}",
                "config": "9b1523e6-7f4a-4bd0-82fd-9ed0e2bae171",
                "params": {
                    "body": "<p>{%for vars.item in vars.alerts%}{%endfor%}<\/p>\n<table border=\"1\" style=\"border-collapse: collapse; width: 99.9951%; background-color: #1e3d67; border-color: #34495E; border-style: dotted;\">\n<tbody>\n<tr>\n<td style=\"text-align: center;\">ID<\/td>\n<td style=\"text-align: center;\">Name<\/td>\n<td style=\"text-align: center;\">Type<\/td>\n<td style=\"text-align: center;\">Acknowledgment SLA<\/td>\n<td style=\"text-align: center;\">Ack Due By<\/td>\n<td style=\"text-align: center;\">Response SLA<\/td>\n<td style=\"text-align: center;\">Response Due By<\/td>\n<\/tr>\n<tr style=\"text-align: left; background-color: #d1d8dc;\">\n<td>{{vars.item['id']}}<\/td>\n<td>{{vars.item['name']}}<\/td>\n<td>{{vars.item['@type']}}<\/td>\n<td>{{vars.item['Acknowledgment SLA Status']}}<\/td>\n<td>{{vars.item['Ack Due By']}}<\/td>\n<td>{{vars.item['Response SLA Status']}}<\/td>\n<td>{{vars.item['Response Due By']}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>",
                    "subject": "SLA Breach status",
                    "iri_list": "",
                    "cc_recipients": "",
                    "to_recipients": "{{vars.item.assignedTo.email}}",
                    "bcc_recipients": "",
                    "inline_iri_list": ""
                },
                "version": "4.0.0",
                "for_each": {
                    "item": "{{vars.alerts}}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "exchange",
                "operation": "send_email",
                "operationTitle": "Send Email",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "1515",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "ab3b75bc-f2ff-4a0e-81b5-681299d9bbd1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Announcements",
            "description": null,
            "arguments": {
                "when": "{{vars.alerts | length > 0 and vars.create_announcement is true}}",
                "for_each": {
                    "item": "{{vars.alerts}}",
                    "__bulk": false,
                    "parallel": false,
                    "condition": ""
                },
                "resource": {
                    "title": "Alert ID: {{vars.item['id']}} SLA Status",
                    "__replace": "",
                    "description": "<p>{%for vars.item in vars.alerts%}{%endfor%}<\/p>\n<table border=\"1\" style=\"border-collapse: collapse; width: 99.9951%; background-color: #1e3d67; border-color: #34495E; border-style: dotted;\">\n<tbody>\n<tr>\n<td style=\"text-align: center;\">ID<\/td>\n<td style=\"text-align: center;\">Name<\/td>\n<td style=\"text-align: center;\">Type<\/td>\n<td style=\"text-align: center;\">Acknowledgment SLA<\/td>\n<td style=\"text-align: center;\">Ack Due By<\/td>\n<td style=\"text-align: center;\">Response SLA<\/td>\n<td style=\"text-align: center;\">Response Due By<\/td>\n<\/tr>\n<tr style=\"text-align: left; background-color: #d1d8dc;\">\n<td>{{vars.item['id']}}<\/td>\n<td>{{vars.item['name']}}<\/td>\n<td>{{vars.item['@type']}}<\/td>\n<td>{{vars.item['Acknowledgment SLA Status']}}<\/td>\n<td>{{vars.item['Ack Due By']}}<\/td>\n<td>{{vars.item['Response SLA Status']}}<\/td>\n<td>{{vars.item['Response Due By']}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>",
                    "notifyOnEmail": false,
                    "announcementType": "\/api\/3\/picklists\/cfbb2798-ec01-4652-b774-fb2c19e35eb5",
                    "announcementCriticality": "\/api\/3\/picklists\/e8e41070-f135-42f2-892b-7017cbba4024"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/announcements",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "abe363d8-8f69-4b26-a00d-3a4ebb30ac35"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute Remaining Time",
            "description": null,
            "arguments": {
                "_remaining_time": "{%for entry in vars.all_alerts%}\n{{entry.update({\"remaining_ack_time\":((entry.dueBy - arrow.now().int_timestamp)\/60)|round(0, 'ceil'),\"remaining_response_time\":((entry.respDueDate - arrow.now().int_timestamp)\/60)|round(0, 'ceil')})}}\n{%endfor%}"
            },
            "status": null,
            "top": "975",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "b0efe229-fef4-426b-926d-85eb6a98ccb5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Notify Teams Channel",
            "description": null,
            "arguments": {
                "when": "{{vars.alerts|length > 0 and vars.channel_name|length > 0}}",
                "arguments": {
                    "channel_name": "{{vars.channel_name}}",
                    "notification_message": "{{vars.teams_mesasge_body}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/a11cda29-209a-40ad-8d2f-651c226e26c6"
            },
            "status": null,
            "top": "1920",
            "left": "480",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "b6e09f0b-ca50-45c6-8381-3ba2fed6b731"
        },
        {
            "@type": "WorkflowStep",
            "name": "Generate Message Body",
            "description": null,
            "arguments": {
                "body": "<table style=\"border-collapse: collapse; width: 99.9951%; background-color: #1E3D67; border-color: #34495E; border-style: dotted;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"text-align: center;\">ID<\/td>\n<td style=\"text-align: center;\">Name<\/td>\n<td style=\"text-align: center;\">Type<\/td>\n<td style=\"text-align: center;\">Acknowledgment SLA<\/td>\n<td style=\"text-align: center;\">Ack Due By<\/td>\n<td style=\"text-align: center;\">Response SLA<\/td>\n<td style=\"text-align: center;\">Response Due By<\/td>\n<\/tr>    \n{%for entry in vars.alerts%}<tr style=\"text-align: left;background-color: #D1D8DC;\"><td>{{entry['id']}}<\/td><td>{{entry['name']}}<\/td><td>{{entry['@type']}}<\/td><td>{{entry['Acknowledgment SLA Status']}}<\/td><td>{{entry['Ack Due By']}}<\/td><td>{{entry['Response SLA Status']}}<\/td><td>{{entry['Response Due By']}}<\/td><\/tr>{%endfor%}\n<\/tbody>\n<\/table>",
                "teams_mesasge_body": "{%for entry in vars.alerts%}\n- |___Alert ID: {{entry['id']}} aSLA: {{entry.remaining_ack_time}} rSLA: {{entry.remaining_response_time}}___|{%endfor%}"
            },
            "status": null,
            "top": "1515",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "b927169b-68d0-47e5-9c98-2c50849f4d77"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Notification Email",
            "description": null,
            "arguments": {
                "name": "Exchange",
                "when": "{{vars.alerts|length > 0}}",
                "config": "9b1523e6-7f4a-4bd0-82fd-9ed0e2bae171",
                "params": {
                    "body": "<p>{{vars.body}}<\/p>",
                    "subject": "SLA Breach status",
                    "iri_list": "",
                    "cc_recipients": "",
                    "to_recipients": "{{vars.email_recipient}}",
                    "bcc_recipients": "",
                    "inline_iri_list": ""
                },
                "version": "4.0.0",
                "connector": "exchange",
                "operation": "send_email",
                "operationTitle": "Send Email",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "f04fe8fe-c8e0-4714-a308-369bc1f9e26f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Announcement",
            "description": null,
            "arguments": {
                "when": "{{vars.alerts | length > 0 and vars.create_announcement is true}}",
                "resource": {
                    "title": "Alert SLA Status",
                    "__replace": "",
                    "description": "<p>{{vars.body}}<\/p>",
                    "notifyOnEmail": false,
                    "announcementType": "\/api\/3\/picklists\/cfbb2798-ec01-4652-b774-fb2c19e35eb5",
                    "announcementCriticality": "\/api\/3\/picklists\/e8e41070-f135-42f2-892b-7017cbba4024"
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/announcements",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1785",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "f2464a82-b053-474e-a151-601cf8aed42e"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Set SLA Notification Method -> Create Configuration Global Vars",
            "targetStep": "\/api\/3\/workflow_steps\/53082393-d31b-430b-9f26-e597d73f2077",
            "sourceStep": "\/api\/3\/workflow_steps\/7f2fc076-bbe7-46f9-be68-4cf05156b221",
            "label": "Save",
            "isExecuted": false,
            "uuid": "79b7f77d-5fff-46cd-931e-8ef999112df9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/83937a9c-d0c1-41c1-a961-44888db15d8e",
            "sourceStep": "\/api\/3\/workflow_steps\/7c8470ca-69b7-4710-bc67-ea049d0d64db",
            "label": null,
            "isExecuted": false,
            "uuid": "554fc878-1c97-4413-bea4-bf3438b504bb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Playbook Configured",
            "targetStep": "\/api\/3\/workflow_steps\/39dc3f2d-b5e0-42d4-a978-3aad0af0a37c",
            "sourceStep": "\/api\/3\/workflow_steps\/83937a9c-d0c1-41c1-a961-44888db15d8e",
            "label": null,
            "isExecuted": false,
            "uuid": "b3c24c04-b5de-44bc-a0de-5d88e1287e44"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Playbook Configured -> Set SLA Notification Method",
            "targetStep": "\/api\/3\/workflow_steps\/7f2fc076-bbe7-46f9-be68-4cf05156b221",
            "sourceStep": "\/api\/3\/workflow_steps\/39dc3f2d-b5e0-42d4-a978-3aad0af0a37c",
            "label": "no",
            "isExecuted": false,
            "uuid": "b954f891-b46e-48b9-a920-345ccbafba00"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Playbook Configured -> Get PLaybook Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/7ba0643b-fa97-4bc0-a302-308a18bd23c6",
            "sourceStep": "\/api\/3\/workflow_steps\/39dc3f2d-b5e0-42d4-a978-3aad0af0a37c",
            "label": "yes",
            "isExecuted": false,
            "uuid": "9a0e33ec-2f0b-4486-a7df-daded7008233"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Configuration Global Vars -> Get PLaybook Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/7ba0643b-fa97-4bc0-a302-308a18bd23c6",
            "sourceStep": "\/api\/3\/workflow_steps\/53082393-d31b-430b-9f26-e597d73f2077",
            "label": null,
            "isExecuted": false,
            "uuid": "d591810e-b39c-48b1-b6bd-5a444375a754"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Generate Email Body -> Send Email",
            "targetStep": "\/api\/3\/workflow_steps\/f04fe8fe-c8e0-4714-a308-369bc1f9e26f",
            "sourceStep": "\/api\/3\/workflow_steps\/b927169b-68d0-47e5-9c98-2c50849f4d77",
            "label": null,
            "isExecuted": false,
            "uuid": "79fcb420-b884-4ad3-b7df-8d0f3a978941"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Single Recipient -> Generate Email Body",
            "targetStep": "\/api\/3\/workflow_steps\/b927169b-68d0-47e5-9c98-2c50849f4d77",
            "sourceStep": "\/api\/3\/workflow_steps\/833ff579-0d3b-471e-8fb4-8f602a69e9eb",
            "label": "yes",
            "isExecuted": false,
            "uuid": "708174ab-4081-4a4e-b5de-a3fe820f4871"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Single Recipient -> Copy of Send Email",
            "targetStep": "\/api\/3\/workflow_steps\/ab3b75bc-f2ff-4a0e-81b5-681299d9bbd1",
            "sourceStep": "\/api\/3\/workflow_steps\/833ff579-0d3b-471e-8fb4-8f602a69e9eb",
            "label": "no",
            "isExecuted": false,
            "uuid": "ad976894-ef51-4e67-b263-c22ae8ce2139"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Notification Emails -> Create Announcement",
            "targetStep": "\/api\/3\/workflow_steps\/abe363d8-8f69-4b26-a00d-3a4ebb30ac35",
            "sourceStep": "\/api\/3\/workflow_steps\/ab3b75bc-f2ff-4a0e-81b5-681299d9bbd1",
            "label": null,
            "isExecuted": false,
            "uuid": "16d12ace-2a86-4408-bbe8-d9b835f1d92a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Notification Email -> Create Announcement",
            "targetStep": "\/api\/3\/workflow_steps\/f2464a82-b053-474e-a151-601cf8aed42e",
            "sourceStep": "\/api\/3\/workflow_steps\/f04fe8fe-c8e0-4714-a308-369bc1f9e26f",
            "label": null,
            "isExecuted": false,
            "uuid": "8d660618-586f-42ed-928a-4dbcf3dc8d2b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Alert Attributes -> Compute Remaining Time",
            "targetStep": "\/api\/3\/workflow_steps\/b0efe229-fef4-426b-926d-85eb6a98ccb5",
            "sourceStep": "\/api\/3\/workflow_steps\/7071eeaa-3adb-4b42-b632-01f3f7d744c8",
            "label": null,
            "isExecuted": false,
            "uuid": "8d1cb222-ce29-45fb-96bf-4c724a4c9bac"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Remaining Time -> Compute Eligible Alerts",
            "targetStep": "\/api\/3\/workflow_steps\/60844ff8-2bbb-4d5a-9b96-e4cc550f1c3d",
            "sourceStep": "\/api\/3\/workflow_steps\/b0efe229-fef4-426b-926d-85eb6a98ccb5",
            "label": null,
            "isExecuted": false,
            "uuid": "605a0eee-83b2-4603-9450-c4c7e46201b6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Eligible Alerts -> Compute Notification Bodies",
            "targetStep": "\/api\/3\/workflow_steps\/1ed18797-7008-4067-9d34-8dff5eeb7737",
            "sourceStep": "\/api\/3\/workflow_steps\/60844ff8-2bbb-4d5a-9b96-e4cc550f1c3d",
            "label": null,
            "isExecuted": false,
            "uuid": "b4d562ab-276c-4a0e-95f3-d36e59fb09cd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Announcement -> Notify Teams Channel",
            "targetStep": "\/api\/3\/workflow_steps\/b6e09f0b-ca50-45c6-8381-3ba2fed6b731",
            "sourceStep": "\/api\/3\/workflow_steps\/f2464a82-b053-474e-a151-601cf8aed42e",
            "label": null,
            "isExecuted": false,
            "uuid": "67a997d5-19ab-4185-b7a4-b3fd669883f7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Notification Bodies -> Single Recipient",
            "targetStep": "\/api\/3\/workflow_steps\/833ff579-0d3b-471e-8fb4-8f602a69e9eb",
            "sourceStep": "\/api\/3\/workflow_steps\/1ed18797-7008-4067-9d34-8dff5eeb7737",
            "label": null,
            "isExecuted": false,
            "uuid": "14ebbb54-a1d2-4952-8dac-9b20ca826417"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set SLA Notification Method -> No Configuraiton Set",
            "targetStep": "\/api\/3\/workflow_steps\/4d56a1d8-83de-48b1-8486-242b14446290",
            "sourceStep": "\/api\/3\/workflow_steps\/7f2fc076-bbe7-46f9-be68-4cf05156b221",
            "label": "Cancel",
            "isExecuted": false,
            "uuid": "979262b2-cb84-478c-bfd2-462112e9e824"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get PLaybook Configuration -> Get Alert Attributes",
            "targetStep": "\/api\/3\/workflow_steps\/7071eeaa-3adb-4b42-b632-01f3f7d744c8",
            "sourceStep": "\/api\/3\/workflow_steps\/7ba0643b-fa97-4bc0-a302-308a18bd23c6",
            "label": null,
            "isExecuted": false,
            "uuid": "1e6b9c07-2a47-4249-9984-3a02a372c41a"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "6804f821-bba2-4409-9e26-f06735d08675",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Use-Case",
        "SLA-Notifier"
    ]
}